# ft_linear_regression
В этом проекте реализован мой первый алгоритм машинного обучения. 

В репозитории представлены две версии программы консольная и версия с графическим интерфейсом.

В данном проекте представлена реализация линейной регрессии. Суть которой заключается в определении коэффициентов `k` и `b` для построения прямой, минимально удаленной от всех точек графика данных.

Нахождение коэффициентов `k` и `b` выполняется на основе среднеквадратичной функции потерь (MSE среднеквадратичная ошибка).

$$MSE = \sum_{i = 0}^{n}\frac{(Y_{i} - y_{i})^2}{n}$$

Где `Yi` это значение прямой, а `yi` это значение данных из файла. 

$$Y = k \cdot x + b$$

Подставим в формулу и получим функцию от двух переменных.

$$f(k, b) = \sum_{i = 0}^{n}\frac{(k \cdot x_{i} + b - y_{i})^2}{n}$$

Далее нужно найти минимальное значение получившейся функции, для этого нам нужно взять частные производные по `k` и по `b`.

$$\frac{\partial f}{\partial k} = \sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i})\cdot x_i}{n}$$

$$\frac{\partial f}{\partial b} = \sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i})}{n}$$

Решив получившуюся систему уравнений мы получим коэффициенты `k` и `b`.

$$\sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i}) }{n} = 0$$

$$\sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i})\cdot x_i}{n} = 0$$

В проекте для нахождения коэффициентов `k` и `b` используются метод градиентного спуска. Подбирается шаг `lr` и "спускаемся" по функциям частных производных высчитывая на каждом шагу коэффициенты `k` и `b`. Делаем это до тех пор пока среднеквадратичная ошибка (MSE) на текущем шаге не будет больше чем на предыдущем.

$$k_{new} = k - lr\cdot \sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i})\cdot x_i}{n}$$

$$b_{new} = b - lr\cdot \sum_{i = 0}^{n}\frac{2\cdot (k \cdot x_{i} + b - y_{i})}{n}$$

## Консольная версия
Консольная версия представлена в виде двух программ. Программы по обучении `ft_linear_regression` и программы по выводу значения `forecast`. Программа `ft_linear_regression` считывает данные из файла, имя которого передается вторым аргументом при запуске. На основе данных вычисляет коэффициенты `k` и `b` прямой линии, минимально отдаленной от всех точек. Коэффициенты `k` и `b` сохраняются в файл "rezult.csv". Программа `forecast` считывает коэффициенты `k` и `b` из файла "rezult.csv" и выводит значение линейной функции на основе числа переданного в качестве второго аргумента.

### Использование
```bash
    git clone https://github.com/MixFon/ft_linear_regression.git
    cd ft_linear_regression/LinearRegression/LinearRegression
    make
    ./ft_linear_regression data.csv
    > -0.019402453931589177 8008.438885070447
    cat rezult.csv
    > k,b
    > -0.019402453931589177,8008.438885070447
    ./forecast 74000
    > k = -0.019402453931589177
    > b = 8008.438885070447
    > 6572.657294132849
```

## Визуальный режим

Визуальный режим находится ветке UILinearRegression.

В визуальном режиме совмещены две программы в одну. В окно ввода текста вводится информация для обучения. После нажатия на кнопку Read информация считывается и обрабатывается.

### Использование

Для запуска визуального режима необходим XCode.
```bash
    git clone https://github.com/MixFon/ft_linear_regression.git
    cd ft_linear_regression
    git checkout UILinearRegression
    cd UILinearRegression
    open UILinearRegression.xcodeproj
```
![gif](https://github.com/MixFon/ft_linear_regression/blob/master/images/Screen_Recording.gif)
